[phases.setup]
nixPkgs = ["nodejs-20_x", "npm-10_x"]

[phases.install]
cmds = ["npm ci --legacy-peer-deps"]

[phases.build]
cmds = [
  "echo '=== Starting HERA build process ==='",
  "echo 'Current directory:' && pwd",
  "echo 'Directory contents:' && ls -la",
  "npm run build:railway",
  "echo '=== Build completed. Checking artifacts ==='",
  "ls -la .next 2>/dev/null || echo '.next directory not found'",
  "test -f .next/BUILD_ID && echo 'BUILD_ID found' || echo 'BUILD_ID missing'",
  "test -f .next/prerender-manifest.json && echo 'prerender-manifest.json found' || echo 'prerender-manifest.json missing'",
  "node scripts/verify-next-build.js || true"
]

[start]
cmd = "node simple-server.js"