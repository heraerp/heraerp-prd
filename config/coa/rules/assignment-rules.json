{
  "rule_definitions": {
    "mandatory_rules": [
      {
        "rule_id": "country_template_required",
        "rule_name": "Country Template Mandatory",
        "rule_type": "validation",
        "priority": 1,
        "is_active": true,
        "condition": {
          "organization": {
            "country": {
              "required": true,
              "not_null": true
            }
          }
        },
        "action": {
          "require_country_template": true,
          "block_assignment_without_country": true,
          "error_message": "Organization must have a country-specific template assigned"
        },
        "description": "All organizations must have a country-specific COA template for regulatory compliance"
      },
      {
        "rule_id": "base_template_immutable",
        "rule_name": "Base Template Always Universal",
        "rule_type": "system",
        "priority": 1,
        "is_active": true,
        "condition": {
          "template_assignment": {
            "base_template": {
              "exists": true
            }
          }
        },
        "action": {
          "force_base_template": "universal_base",
          "prevent_base_modification": true,
          "info_message": "Base template is always 'universal_base' and cannot be changed"
        },
        "description": "The base template must always be 'universal_base' for system consistency"
      }
    ],
    "recommended_rules": [
      {
        "rule_id": "industry_template_suggested",
        "rule_name": "Industry Template Recommended",
        "rule_type": "recommendation",
        "priority": 2,
        "is_active": true,
        "condition": {
          "organization": {
            "industry": {
              "exists": true,
              "not_empty": true
            }
          }
        },
        "action": {
          "suggest_industry_template": true,
          "show_industry_benefits": true,
          "allow_skip": true,
          "info_message": "An industry-specific template is recommended for your business type"
        },
        "description": "Recommend industry-specific template when organization industry is known"
      },
      {
        "rule_id": "multi_location_governance",
        "rule_name": "Multi-Location Template Consistency",
        "rule_type": "governance",
        "priority": 2,
        "is_active": true,
        "condition": {
          "organization": {
            "has_multiple_locations": true,
            "parent_organization_id": {
              "exists": true
            }
          }
        },
        "action": {
          "inherit_parent_templates": true,
          "require_approval_for_deviation": true,
          "warning_message": "Consider using the same template structure as your parent organization"
        },
        "description": "Maintain template consistency across multiple locations of the same organization"
      }
    ],
    "governance_rules": [
      {
        "rule_id": "lock_after_golive",
        "rule_name": "Lock Templates After Go-Live",
        "rule_type": "governance",
        "priority": 1,
        "is_active": true,
        "condition": {
          "organization": {
            "status": "live",
            "has_transactions": true
          },
          "coa_config": {
            "transaction_count": {
              "greater_than": 0
            }
          }
        },
        "action": {
          "lock_template_changes": true,
          "require_admin_approval": true,
          "backup_before_change": true,
          "error_message": "Template changes require administrator approval after go-live with transactions"
        },
        "description": "Prevent unauthorized COA template changes after organization goes live with financial transactions"
      },
      {
        "rule_id": "fiscal_year_alignment",
        "rule_name": "Fiscal Year Template Alignment",
        "rule_type": "governance",
        "priority": 3,
        "is_active": true,
        "condition": {
          "organization": {
            "fiscal_year_end": {
              "exists": true
            }
          },
          "template_change": {
            "during_fiscal_year": true
          }
        },
        "action": {
          "warn_fiscal_impact": true,
          "require_justification": true,
          "schedule_for_year_end": true,
          "warning_message": "Template changes during fiscal year may impact financial reporting"
        },
        "description": "Manage COA template changes to minimize impact on fiscal year reporting"
      }
    ],
    "validation_rules": [
      {
        "rule_id": "template_compatibility",
        "rule_name": "Template Layer Compatibility",
        "rule_type": "validation",
        "priority": 1,
        "is_active": true,
        "condition": {
          "template_assignment": {
            "country_template": {
              "exists": true
            },
            "industry_template": {
              "exists": true
            }
          }
        },
        "action": {
          "validate_compatibility": true,
          "check_account_conflicts": true,
          "resolve_conflicts_automatically": false,
          "error_message": "Selected country and industry templates have conflicting account definitions"
        },
        "description": "Ensure country and industry templates don't have conflicting account definitions"
      },
      {
        "rule_id": "regulatory_compliance",
        "rule_name": "Regulatory Compliance Check",
        "rule_type": "validation",
        "priority": 1,
        "is_active": true,
        "condition": {
          "organization": {
            "regulatory_requirements": {
              "exists": true
            }
          }
        },
        "action": {
          "validate_required_accounts": true,
          "check_mandatory_fields": true,
          "verify_reporting_capabilities": true,
          "error_message": "Selected template combination doesn't meet regulatory requirements"
        },
        "description": "Verify that template assignment meets all regulatory and compliance requirements"
      }
    ]
  },
  "rule_execution_order": [
    "system",
    "validation",
    "governance",
    "recommendation"
  ],
  "rule_categories": {
    "system": {
      "description": "Core system rules that cannot be overridden",
      "can_disable": false,
      "priority_range": [1, 1]
    },
    "validation": {
      "description": "Data validation and integrity rules",
      "can_disable": false,
      "priority_range": [1, 2]
    },
    "governance": {
      "description": "Business governance and approval rules",
      "can_disable": true,
      "priority_range": [1, 3]
    },
    "recommendation": {
      "description": "Helpful suggestions and best practices",
      "can_disable": true,
      "priority_range": [2, 5]
    }
  },
  "custom_rule_template": {
    "rule_id": "custom_rule_{{id}}",
    "rule_name": "Custom Rule Name",
    "rule_type": "validation|governance|recommendation",
    "priority": 3,
    "is_active": true,
    "condition": {
      "organization": {},
      "template_assignment": {},
      "coa_config": {}
    },
    "action": {
      "custom_action": true,
      "message": "Custom message"
    },
    "description": "Description of what this rule does"
  }
}